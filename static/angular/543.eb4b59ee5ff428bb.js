"use strict";var te=Object.defineProperty,ee=Object.defineProperties,ne=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,X=(v,y,g)=>y in v?te(v,y,{enumerable:!0,configurable:!0,writable:!0,value:g}):v[y]=g,Z=(v,y)=>{for(var g in y||(y={}))q.call(y,g)&&X(v,g,y[g]);if(R)for(var g of R(y))U.call(y,g)&&X(v,g,y[g]);return v},Q=(v,y)=>ee(v,ne(y)),tt=(v,y)=>{var g={};for(var u in v)q.call(v,u)&&y.indexOf(u)<0&&(g[u]=v[u]);if(null!=v&&R)for(var u of R(v))y.indexOf(u)<0&&U.call(v,u)&&(g[u]=v[u]);return g};(self.webpackChunkcanvas_gamification_ui=self.webpackChunkcanvas_gamification_ui||[]).push([[543],{42543:(v,y,g)=>{g.r(y),g.d(y,{default:()=>Qt});var u=g(94016);const et=/^\s*>\s$/,nt=u.NB.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:t}){return["blockquote",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[(0,u.S0)({find:et,type:this.type})]}}),rt=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,st=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,it=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,ot=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,at=u.vc.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:t=>"normal"!==t.style.fontWeight&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],renderHTML({HTMLAttributes:t}){return["strong",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[(0,u.Cf)({find:rt,type:this.type}),(0,u.Cf)({find:it,type:this.type})]},addPasteRules(){return[(0,u.K9)({find:st,type:this.type}),(0,u.K9)({find:ot,type:this.type})]}}),ut=/^\s*([-+*])\s$/,lt=u.NB.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:t}){return["ul",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[(0,u.S0)({find:ut,type:this.type})]}}),dt=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,pt=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,ct=u.vc.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:t}){return["code",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[(0,u.Cf)({find:dt,type:this.type})]},addPasteRules(){return[(0,u.K9)({find:pt,type:this.type})]}});var M=g(10647);const ht=/^```([a-z]+)?[\s\n]$/,ft=/^~~~([a-z]+)?[\s\n]$/,gt=u.NB.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;return[...(null===(e=t.firstElementChild)||void 0===e?void 0:e.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:t,HTMLAttributes:e}){return["pre",(0,u.P1)(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection;return!(!t||e.parent.type.name!==this.name)&&!(1!==e.pos&&e.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith("\n\n");return!(!o||!i)&&t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||s.parentOffset!==s.parent.nodeSize-2)return!1;const a=s.after();return void 0!==a&&!r.nodeAt(a)&&t.commands.exitCode()}}},addInputRules(){return[(0,u.zK)({find:ht,type:this.type,getAttributes:t=>({language:t[1]})}),(0,u.zK)({find:ft,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new M.Sy({key:new M.H$("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=null==s?void 0:s.mode;if(!n||!o)return!1;const{tr:i}=t.state;return i.replaceSelectionWith(this.type.create({language:o})),i.setSelection(M.Bs.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.insertText(n.replace(/\r\n?/g,"\n")),i.setMeta("paste",!0),t.dispatch(i),!0}}})]}}),mt=u.NB.create({name:"doc",topNode:!0,content:"block+"});var K=g(99163),k=function(e,n){var r=this;this.editorView=e,this.width=n.width||1,this.color=n.color||"black",this.class=n.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map(function(s){var o=function(i){return r[s](i)};return e.dom.addEventListener(s,o),{name:s,handler:o}})};k.prototype.destroy=function(){var e=this;this.handlers.forEach(function(n){return e.editorView.dom.removeEventListener(n.name,n.handler)})},k.prototype.update=function(e,n){null!=this.cursorPos&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())},k.prototype.setCursor=function(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},k.prototype.updateOverlay=function(){var n,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var r=e.nodeBefore,s=e.nodeAfter;if(r||s){var o=this.editorView.nodeDOM(this.cursorPos-(r?r.nodeSize:0)).getBoundingClientRect(),i=r?o.bottom:o.top;r&&s&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:o.left,right:o.right,top:i-this.width/2,bottom:i+this.width/2}}}if(!n){var a=this.editorView.coordsAtPos(this.cursorPos);n={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}var d,h,l=this.editorView.dom.offsetParent;if(this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!l||l==document.body&&"static"==getComputedStyle(l).position)d=-pageXOffset,h=-pageYOffset;else{var p=l.getBoundingClientRect();d=p.left-l.scrollLeft,h=p.top-l.scrollTop}this.element.style.left=n.left-d+"px",this.element.style.top=n.top-h+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"},k.prototype.scheduleRemoval=function(e){var n=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){return n.setCursor(null)},e)},k.prototype.dragover=function(e){if(this.editorView.editable){var n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),s=r&&r.type.spec.disableDropCursor,o="function"==typeof s?s(this.editorView,n):s;if(n&&!o){var i=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(i=(0,K.nj)(this.editorView.state.doc,i,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(i),this.scheduleRemoval(5e3)}}},k.prototype.dragend=function(){this.scheduleRemoval(20)},k.prototype.drop=function(){this.scheduleRemoval(20)},k.prototype.dragleave=function(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)};const yt=u.hj.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:null}),addProseMirrorPlugins(){return[(t=this.options,void 0===t&&(t={}),new M.Sy({view:function(n){return new k(n,t)}}))];var t}});var Mt=g(74136),P=g(94242),V=g(90805),w=function(t){function e(n){t.call(this,n,n)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.map=function(r,s){var o=r.resolve(s.map(this.head));return e.valid(o)?new e(o):t.near(o)},e.prototype.content=function(){return P.p2.empty},e.prototype.eq=function(r){return r instanceof e&&r.head==this.head},e.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(r,s){if("number"!=typeof s.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(r.resolve(s.pos))},e.prototype.getBookmark=function(){return new S(this.anchor)},e.valid=function(r){var s=r.parent;if(s.isTextblock||!function bt(t){for(var e=t.depth;e>=0;e--){var n=t.index(e),r=t.node(e);if(0!=n)for(var s=r.child(n-1);;s=s.lastChild){if(0==s.childCount&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(r)||!function Ct(t){for(var e=t.depth;e>=0;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var s=r.child(n);;s=s.firstChild){if(0==s.childCount&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(r))return!1;var o=s.type.spec.allowGapCursor;if(null!=o)return o;var i=s.contentMatchAt(r.index()).defaultType;return i&&i.isTextblock},e.findFrom=function(r,s,o){t:for(;;){if(!o&&e.valid(r))return r;for(var i=r.pos,a=null,l=r.depth;;l--){var d=r.node(l);if(s>0?r.indexAfter(l)<d.childCount:r.index(l)>0){a=d.child(s>0?r.indexAfter(l):r.index(l)-1);break}if(0==l)return null;var h=r.doc.resolve(i+=s);if(e.valid(h))return h}for(;;){var p=s>0?a.firstChild:a.lastChild;if(!p){if(a.isAtom&&!a.isText&&!M.qv.isSelectable(a)){r=r.doc.resolve(i+a.nodeSize*s),o=!1;continue t}break}a=p;var f=r.doc.resolve(i+=s);if(e.valid(f))return f}return null}},e}(M.Y1);w.prototype.visible=!1,M.Y1.jsonID("gapcursor",w);var S=function(e){this.pos=e};S.prototype.map=function(e){return new S(e.map(this.pos))},S.prototype.resolve=function(e){var n=e.resolve(this.pos);return w.valid(n)?new w(n):M.Y1.near(n)};var Tt=(0,Mt.$)({ArrowLeft:B("horiz",-1),ArrowRight:B("horiz",1),ArrowUp:B("vert",-1),ArrowDown:B("vert",1)});function B(t,e){var n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(r,s,o){var i=r.selection,a=e>0?i.$to:i.$from,l=i.empty;if(i instanceof M.Bs){if(!o.endOfTextblock(n)||0==a.depth)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}var d=w.findFrom(a,e,l);return!!d&&(s&&s(r.tr.setSelection(new w(d))),!0)}}function kt(t,e,n){if(!t.editable)return!1;var r=t.state.doc.resolve(e);if(!w.valid(r))return!1;var o=t.posAtCoords({left:n.clientX,top:n.clientY}).inside;return!(o>-1&&M.qv.isSelectable(t.state.doc.nodeAt(o))||(t.dispatch(t.state.tr.setSelection(new w(r))),0))}function _t(t,e){if("insertCompositionText"!=e.inputType||!(t.state.selection instanceof w))return!1;var r=t.state.selection.$from,s=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!s)return!1;for(var o=P.HY.empty,i=s.length-1;i>=0;i--)o=P.HY.from(s[i].createAndFill(null,o));var a=t.state.tr.replace(r.pos,r.pos,new P.p2(o,0,0));return a.setSelection(M.Bs.near(a.doc.resolve(r.pos+1))),t.dispatch(a),!1}function At(t){if(!(t.selection instanceof w))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",V.EH.create(t.doc,[V.p.widget(t.selection.head,e,{key:"gapcursor"})])}const It=u.hj.create({name:"gapCursor",addProseMirrorPlugins:()=>[new M.Sy({props:{decorations:At,createSelectionBetween:function(e,n,r){if(n.pos==r.pos&&w.valid(r))return new w(r)},handleClick:kt,handleKeyDown:Tt,handleDOMEvents:{beforeinput:_t}}})],extendNodeSchema(t){var e;return{allowGapCursor:null!==(e=(0,u.nU)((0,u.Nl)(t,"allowGapCursor",{name:t.name,options:t.options,storage:t.storage})))&&void 0!==e?e:null}}}),Lt=u.NB.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:t}){return["br",(0,u.P1)(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,l=o||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:h})=>{if(h&&l&&i){const p=l.filter(f=>a.includes(f.type.name));d.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Ht=u.NB.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,(0,u.P1)(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.setNode(this.name,t),toggleHeading:t=>({commands:e})=>!!this.options.levels.includes(t.level)&&e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>Q(Z({},t),{[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>(0,u.zK)({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var O=200,b=function(){};b.prototype.append=function(e){return e.length?(e=b.from(e),!this.length&&e||e.length<O&&this.leafAppend(e)||this.length<O&&e.leafPrepend(this)||this.appendInner(e)):this},b.prototype.prepend=function(e){return e.length?b.from(e).append(this):this},b.prototype.appendInner=function(e){return new xt(this,e)},b.prototype.slice=function(e,n){return void 0===e&&(e=0),void 0===n&&(n=this.length),e>=n?b.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))},b.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},b.prototype.forEach=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)},b.prototype.map=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=this.length);var s=[];return this.forEach(function(o,i){return s.push(e(o,i))},n,r),s},b.from=function(e){return e instanceof b?e:e&&e.length?new z(e):b.empty};var z=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,o){return 0==s&&o==this.length?this:new e(this.values.slice(s,o))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,o,i,a){for(var l=o;l<i;l++)if(!1===s(this.values[l],a+l))return!1},e.prototype.forEachInvertedInner=function(s,o,i,a){for(var l=o-1;l>=i;l--)if(!1===s(this.values[l],a+l))return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=O)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=O)return new e(s.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(b);b.empty=new z([]);var xt=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,o,i){var a=this.left.length;if(s<a&&!1===this.left.forEachInner(r,s,Math.min(o,a),i)||o>a&&!1===this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,o)-a,i+a))return!1},e.prototype.forEachInvertedInner=function(r,s,o,i){var a=this.left.length;if(s>a&&!1===this.right.forEachInvertedInner(r,s-a,Math.max(o,a)-a,i+a)||o<a&&!1===this.left.forEachInvertedInner(r,Math.min(s,a),o,i))return!1},e.prototype.sliceInner=function(r,s){if(0==r&&s==this.length)return this;var o=this.left.length;return s<=o?this.left.slice(r,s):r>=o?this.right.slice(r-o,s-o):this.left.slice(r,o).append(this.right.slice(0,s-o))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(b);const $=b;var C=function(e,n){this.items=e,this.eventCount=n};C.prototype.popEvent=function(e,n){var i,a,r=this;if(0==this.eventCount)return null;for(var s=this.items.length;;s--)if(this.items.get(s-1).selection){--s;break}n&&(i=this.remapping(s,this.items.length),a=i.maps.length);var d,h,l=e.tr,p=[],f=[];return this.items.forEach(function(c,T){if(!c.step)return i||(i=r.remapping(s,T+1),a=i.maps.length),a--,void f.push(c);if(i){f.push(new _(c.map));var I,L=c.step.map(i.slice(a));L&&l.maybeStep(L).doc&&p.push(new _(I=l.mapping.maps[l.mapping.maps.length-1],null,null,p.length+f.length)),a--,I&&i.appendMap(I,a)}else l.maybeStep(c.step);return c.selection?(d=i?c.selection.map(i.slice(a)):c.selection,h=new C(r.items.slice(0,s).append(f.reverse().concat(p)),r.eventCount-1),!1):void 0},this.items.length,0),{remaining:h,transform:l,selection:d}},C.prototype.addTransform=function(e,n,r,s){for(var o=[],i=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null,d=0;d<e.steps.length;d++){var f,h=e.steps[d].invert(e.docs[d]),p=new _(e.mapping.maps[d],h,n);(f=l&&l.merge(p))&&(p=f,d?o.pop():a=a.slice(0,a.length-1)),o.push(p),n&&(i++,n=null),s||(l=p)}var c=i-r.depth;return c>Ot&&(a=function Bt(t,e){var n;return t.forEach(function(r,s){if(r.selection&&0==e--)return n=s,!1}),t.slice(n)}(a,c),i-=c),new C(a.append(o),i)},C.prototype.remapping=function(e,n){var r=new K.vs;return this.items.forEach(function(s,o){r.appendMap(s.map,null!=s.mirrorOffset&&o-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:null)},e,n),r},C.prototype.addMaps=function(e){return 0==this.eventCount?this:new C(this.items.append(e.map(function(n){return new _(n)})),this.eventCount)},C.prototype.rebased=function(e,n){if(!this.eventCount)return this;var r=[],s=Math.max(0,this.items.length-n),o=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach(function(c){c.selection&&a--},s);var l=n;this.items.forEach(function(c){var T=o.getMirror(--l);if(null!=T){i=Math.min(i,T);var L=o.maps[T];if(c.step){var I=e.steps[T].invert(e.docs[T]),x=c.selection&&c.selection.map(o.slice(l+1,T));x&&a++,r.push(new _(L,I,x))}else r.push(new _(L))}},s);for(var d=[],h=n;h<i;h++)d.push(new _(o.maps[h]));var p=this.items.slice(0,s).append(d).append(r),f=new C(p,a);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-r.length)),f},C.prototype.emptyItemCount=function(){var e=0;return this.items.forEach(function(n){n.step||e++}),e},C.prototype.compress=function(e){void 0===e&&(e=this.items.length);var n=this.remapping(0,e),r=n.maps.length,s=[],o=0;return this.items.forEach(function(i,a){if(a>=e)s.push(i),i.selection&&o++;else if(i.step){var l=i.step.map(n.slice(r)),d=l&&l.getMap();if(r--,d&&n.appendMap(d,r),l){var h=i.selection&&i.selection.map(n.slice(r));h&&o++;var f,p=new _(d.invert(),l,h),c=s.length-1;(f=s.length&&s[c].merge(p))?s[c]=f:s.push(p)}}else i.map&&r--},this.items.length,0),new C($.from(s.reverse()),o)},C.empty=new C($.empty,0);var _=function(e,n,r,s){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=s};_.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var n=e.step.merge(this.step);if(n)return new _(n.getMap().invert(),n,this.selection)}};var H=function(e,n,r,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=s},Ot=20;function G(t){var e=[];return t.forEach(function(n,r,s,o){return e.push(s,o)}),e}function N(t,e){if(!t)return null;for(var n=[],r=0;r<t.length;r+=2){var s=e.map(t[r],1),o=e.map(t[r+1],-1);s<=o&&n.push(s,o)}return n}function j(t,e,n,r){var s=E(e),o=A.get(e).spec.config,i=(r?t.undone:t.done).popEvent(e,s);if(i){var a=i.selection.resolve(i.transform.doc),l=(r?t.done:t.undone).addTransform(i.transform,e.selection.getBookmark(),o,s),d=new H(r?l:i.remaining,r?i.remaining:l,null,0);n(i.transform.setSelection(a).setMeta(A,{redo:r,historyState:d}).scrollIntoView())}}var D=!1,W=null;function E(t){var e=t.plugins;if(W!=e){D=!1,W=e;for(var n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){D=!0;break}}return D}var A=new M.H$("history"),F=new M.H$("closeHistory");function Y(t,e){var n=A.getState(t);return!(!n||0==n.done.eventCount||(e&&j(n,t,e,!1),0))}function J(t,e){var n=A.getState(t);return!(!n||0==n.undone.eventCount||(e&&j(n,t,e,!0),0))}const Dt=u.hj.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:t,dispatch:e})=>Y(t,e),redo:()=>({state:t,dispatch:e})=>J(t,e)}),addProseMirrorPlugins(){return[(t=this.options,new M.Sy({key:A,state:{init:function(){return new H(C.empty,C.empty,null,0)},apply:function(n,r,s){return function Et(t,e,n,r){var o,s=n.getMeta(A);if(s)return s.historyState;n.getMeta(F)&&(t=new H(t.done,t.undone,null,0));var i=n.getMeta("appendedTransaction");if(0==n.steps.length)return t;if(i&&i.getMeta(A))return i.getMeta(A).redo?new H(t.done.addTransform(n,null,r,E(e)),t.undone,G(n.mapping.maps[n.steps.length-1]),t.prevTime):new H(t.done,t.undone.addTransform(n,null,r,E(e)),null,t.prevTime);if(!1===n.getMeta("addToHistory")||i&&!1===i.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new H(t.done.rebased(n,o),t.undone.rebased(n,o),N(t.prevRanges,n.mapping),t.prevTime):new H(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),N(t.prevRanges,n.mapping),t.prevTime);var a=0==t.prevTime||!i&&(t.prevTime<(n.time||0)-r.newGroupDelay||!function Rt(t,e){if(!e)return!1;if(!t.docChanged)return!0;var n=!1;return t.mapping.maps[0].forEach(function(r,s){for(var o=0;o<e.length;o+=2)r<=e[o+1]&&s>=e[o]&&(n=!0)}),n}(n,t.prevRanges)),l=i?N(t.prevRanges,n.mapping):G(n.mapping.maps[n.steps.length-1]);return new H(t.done.addTransform(n,a?e.selection.getBookmark():null,r,E(e)),C.empty,l,n.time)}(r,s,n,t)}},config:t={depth:t&&t.depth||100,newGroupDelay:t&&t.newGroupDelay||500},props:{handleDOMEvents:{beforeinput:function(n,r){var s="historyUndo"==r.inputType?Y(n.state,n.dispatch):"historyRedo"==r.inputType&&J(n.state,n.dispatch);return s&&r.preventDefault(),s}}}}))];var t},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),Kt=u.NB.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:t}){return["hr",(0,u.P1)(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command(({tr:e,dispatch:n})=>{var r;if(n){const{$to:s}=e.selection,o=s.end();if(s.nodeAfter)e.setSelection(M.Bs.create(e.doc,s.pos));else{const i=null===(r=s.parent.type.contentMatch.defaultType)||void 0===r?void 0:r.create();i&&(e.insert(o,i),e.setSelection(M.Bs.create(e.doc,o)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[(0,u.x2)({find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type})]}}),Vt=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,zt=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,$t=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Gt=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,jt=u.vc.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:t=>"normal"!==t.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:t}){return["em",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[(0,u.Cf)({find:Vt,type:this.type}),(0,u.Cf)({find:$t,type:this.type})]},addPasteRules(){return[(0,u.K9)({find:zt,type:this.type}),(0,u.K9)({find:Gt,type:this.type})]}}),Wt=u.NB.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:t}){return["li",(0,u.P1)(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ft=/^(\d+)\.\s$/,Yt=u.NB.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:t}){const r=t,{start:e}=r,n=tt(r,["start"]);return 1===e?["ol",(0,u.P1)(this.options.HTMLAttributes,n),0]:["ol",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[(0,u.S0)({find:Ft,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]})]}}),Jt=u.NB.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:t}){return["p",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),qt=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Ut=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Xt=u.vc.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>!!t.includes("line-through")&&{}}],renderHTML({HTMLAttributes:t}){return["s",(0,u.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[(0,u.Cf)({find:qt,type:this.type})]},addPasteRules(){return[(0,u.K9)({find:Ut,type:this.type})]}}),Zt=u.NB.create({name:"text",group:"inline"}),Qt=u.hj.create({name:"starterKit",addExtensions(){var t,e,n,r,s,o,i,a,l,d,h,p,f,c,T,L,I,x;const m=[];return!1!==this.options.blockquote&&m.push(nt.configure(null===(t=this.options)||void 0===t?void 0:t.blockquote)),!1!==this.options.bold&&m.push(at.configure(null===(e=this.options)||void 0===e?void 0:e.bold)),!1!==this.options.bulletList&&m.push(lt.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&m.push(ct.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&m.push(gt.configure(null===(s=this.options)||void 0===s?void 0:s.codeBlock)),!1!==this.options.document&&m.push(mt.configure(null===(o=this.options)||void 0===o?void 0:o.document)),!1!==this.options.dropcursor&&m.push(yt.configure(null===(i=this.options)||void 0===i?void 0:i.dropcursor)),!1!==this.options.gapcursor&&m.push(It.configure(null===(a=this.options)||void 0===a?void 0:a.gapcursor)),!1!==this.options.hardBreak&&m.push(Lt.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&m.push(Ht.configure(null===(d=this.options)||void 0===d?void 0:d.heading)),!1!==this.options.history&&m.push(Dt.configure(null===(h=this.options)||void 0===h?void 0:h.history)),!1!==this.options.horizontalRule&&m.push(Kt.configure(null===(p=this.options)||void 0===p?void 0:p.horizontalRule)),!1!==this.options.italic&&m.push(jt.configure(null===(f=this.options)||void 0===f?void 0:f.italic)),!1!==this.options.listItem&&m.push(Wt.configure(null===(c=this.options)||void 0===c?void 0:c.listItem)),!1!==this.options.orderedList&&m.push(Yt.configure(null===(T=this.options)||void 0===T?void 0:T.orderedList)),!1!==this.options.paragraph&&m.push(Jt.configure(null===(L=this.options)||void 0===L?void 0:L.paragraph)),!1!==this.options.strike&&m.push(Xt.configure(null===(I=this.options)||void 0===I?void 0:I.strike)),!1!==this.options.text&&m.push(Zt.configure(null===(x=this.options)||void 0===x?void 0:x.text)),m}})}}]);